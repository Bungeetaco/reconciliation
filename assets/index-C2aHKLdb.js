import{r as e,j as r,S as t,M as a,D as n,F as s,U as o,X as l,C as i,a as c,c as d,b as m,d as u,e as b,f as h,R as g}from"./ui-dpVq882R.js";import{a as p,g as y,b as f,u as x,c as v,w as k}from"./vendor-76Na0Azn.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))r(e);new MutationObserver((e=>{for(const t of e)if("childList"===t.type)for(const e of t.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&r(e)})).observe(document,{childList:!0,subtree:!0})}function r(e){if(e.ep)return;e.ep=!0;const r=function(e){const r={};return e.integrity&&(r.integrity=e.integrity),e.referrerPolicy&&(r.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?r.credentials="include":"anonymous"===e.crossOrigin?r.credentials="omit":r.credentials="same-origin",r}(e);fetch(e.href,r)}}();var N,w={};const j=y(function(){if(N)return w;N=1;var e=p();return w.createRoot=e.createRoot,w.hydrateRoot=e.hydrateRoot,w}());var C=(e,r,t,a,n,s,o,l)=>{let i=document.documentElement,c=["light","dark"];function d(r){(Array.isArray(e)?e:[e]).forEach((e=>{let t="class"===e,a=t&&s?n.map((e=>s[e]||e)):n;t?(i.classList.remove(...a),i.classList.add(r)):i.setAttribute(e,r)})),function(e){l&&c.includes(e)&&(i.style.colorScheme=e)}(r)}if(a)d(a);else try{let e=localStorage.getItem(r)||t;d(o&&"system"===e?window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light":e)}catch(m){}},P=["light","dark"],S="(prefers-color-scheme: dark)",A="undefined"==typeof window,E=e.createContext(void 0),M={setTheme:e=>{},themes:[]},T=r=>e.useContext(E)?e.createElement(e.Fragment,null,r.children):e.createElement(D,{...r}),L=["light","dark"],D=({forcedTheme:r,disableTransitionOnChange:t=!1,enableSystem:a=!0,enableColorScheme:n=!0,storageKey:s="theme",themes:o=L,defaultTheme:l=(a?"system":"light"),attribute:i="data-theme",value:c,children:d,nonce:m,scriptProps:u})=>{let[b,h]=e.useState((()=>F(s,l))),[g,p]=e.useState((()=>F(s))),y=c?Object.values(c):o,f=e.useCallback((e=>{let r=e;if(!r)return;"system"===e&&a&&(r=U());let s=c?c[r]:r,o=t?R(m):null,d=document.documentElement,u=e=>{"class"===e?(d.classList.remove(...y),s&&d.classList.add(s)):e.startsWith("data-")&&(s?d.setAttribute(e,s):d.removeAttribute(e))};if(Array.isArray(i)?i.forEach(u):u(i),n){let e=P.includes(l)?l:null,t=P.includes(r)?r:e;d.style.colorScheme=t}null==o||o()}),[m]),x=e.useCallback((e=>{let r="function"==typeof e?e(b):e;h(r);try{localStorage.setItem(s,r)}catch(t){}}),[b]),v=e.useCallback((e=>{let t=U(e);p(t),"system"===b&&a&&!r&&f("system")}),[b,r]);e.useEffect((()=>{let e=window.matchMedia(S);return e.addListener(v),v(e),()=>e.removeListener(v)}),[v]),e.useEffect((()=>{let e=e=>{e.key===s&&(e.newValue?h(e.newValue):x(l))};return window.addEventListener("storage",e),()=>window.removeEventListener("storage",e)}),[x]),e.useEffect((()=>{f(null!=r?r:b)}),[r,b]);let k=e.useMemo((()=>({theme:b,setTheme:x,forcedTheme:r,resolvedTheme:"system"===b?g:b,themes:a?[...o,"system"]:o,systemTheme:a?g:void 0})),[b,x,r,g,a,o]);return e.createElement(E.Provider,{value:k},e.createElement(O,{forcedTheme:r,storageKey:s,attribute:i,enableSystem:a,enableColorScheme:n,defaultTheme:l,value:c,themes:o,nonce:m,scriptProps:u}),d)},O=e.memo((({forcedTheme:r,storageKey:t,attribute:a,enableSystem:n,enableColorScheme:s,defaultTheme:o,value:l,themes:i,nonce:c,scriptProps:d})=>{let m=JSON.stringify([a,t,o,r,i,l,n,s]).slice(1,-1);return e.createElement("script",{...d,suppressHydrationWarning:!0,nonce:"undefined"==typeof window?c:"",dangerouslySetInnerHTML:{__html:`(${C.toString()})(${m})`}})})),F=(e,r)=>{if(A)return;let t;try{t=localStorage.getItem(e)||void 0}catch(a){}return t||r},R=e=>{let r=document.createElement("style");return e&&r.setAttribute("nonce",e),r.appendChild(document.createTextNode("*,*::before,*::after{-webkit-transition:none!important;-moz-transition:none!important;-o-transition:none!important;-ms-transition:none!important;transition:none!important}")),document.head.appendChild(r),()=>{window.getComputedStyle(document.body),setTimeout((()=>{document.head.removeChild(r)}),1)}},U=e=>(e||(e=window.matchMedia(S)),e.matches?"dark":"light");function I({children:e,...t}){return r.jsx(T,{attribute:"class",defaultTheme:"system",enableSystem:!0,...t,children:e})}function $(){const{theme:n,setTheme:s}=null!=(o=e.useContext(E))?o:M;var o;return r.jsxs("button",{onClick:()=>s("dark"===n?"light":"dark"),className:"relative inline-flex items-center justify-center rounded-md p-2.5 text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-800 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-blue-500",children:[r.jsx(t,{className:"h-[1.2rem] w-[1.2rem] rotate-0 scale-100 transition-all dark:-rotate-90 dark:scale-0"}),r.jsx(a,{className:"absolute h-[1.2rem] w-[1.2rem] rotate-90 scale-0 transition-all dark:rotate-0 dark:scale-100"}),r.jsx("span",{className:"sr-only",children:"Toggle theme"})]})}function B({fileName:e,onExport:t}){return r.jsxs(r.Fragment,{children:[r.jsxs("button",{onClick:()=>t("csv"),className:"flex items-center px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",disabled:!e,children:[r.jsx(n,{className:"w-4 h-4 mr-2"}),"CSV"]}),r.jsxs("button",{onClick:()=>t("excel"),className:"flex items-center px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",disabled:!e,children:[r.jsx(n,{className:"w-4 h-4 mr-2"}),"Excel"]}),r.jsxs("button",{onClick:()=>t("html"),className:"flex items-center px-4 py-2 bg-purple-600 text-white rounded hover:bg-purple-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",disabled:!e,children:[r.jsx(n,{className:"w-4 h-4 mr-2"}),"HTML"]}),r.jsxs("button",{onClick:()=>t("pdf"),className:"flex items-center px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",disabled:!e,children:[r.jsx(s,{className:"w-4 h-4 mr-2"}),"PDF"]})]})}function V({onFileUpload:e,fileName:t}){return r.jsxs("div",{className:"relative",children:[r.jsx("input",{type:"file",accept:".csv",onChange:e,className:"hidden",id:"file-upload"}),r.jsxs("label",{htmlFor:"file-upload",className:"flex items-center px-4 py-2 bg-blue-50 text-blue-700 rounded text-sm font-semibold hover:bg-blue-100 cursor-pointer",children:[r.jsx(o,{className:"w-4 h-4 mr-2"}),"Browse..."]}),r.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:t||"No file selected"})]})}function H({searchTerm:e,onSearchChange:t,selectedDepartments:a,onDepartmentChange:n,departments:s,selectedLicenseTypes:o,onLicenseTypesChange:i,licenseTypes:c,showUnknownLicenses:d,onShowUnknownLicensesChange:m,hideZeroCostAccounts:u,onHideZeroCostAccountsChange:b}){return r.jsxs("div",{className:"mt-4 flex flex-col sm:flex-row gap-4 bg-gray-50 dark:bg-gray-800/50 rounded-lg p-4",children:[r.jsxs("div",{className:"relative flex-1",children:[r.jsx("input",{type:"text",placeholder:"Search by name, email, or department...",value:e,onChange:e=>t(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-200 dark:border-gray-700 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 placeholder-gray-500 dark:placeholder-gray-400"}),e&&r.jsx("button",{onClick:()=>t(""),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:r.jsx(l,{className:"w-4 h-4"})})]}),r.jsxs("div",{className:"flex flex-wrap gap-2",children:[r.jsxs("select",{multiple:!0,value:a,onChange:e=>n(Array.from(e.target.selectedOptions,(e=>e.value))),className:"p-2 border border-gray-200 dark:border-gray-700 rounded-lg min-w-[200px] bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100",children:[r.jsx("option",{value:"",disabled:!0,children:"Select Departments"}),s.map((e=>r.jsx("option",{value:e,children:e},e)))]}),r.jsxs("select",{multiple:!0,value:o,onChange:e=>i(Array.from(e.target.selectedOptions,(e=>e.value))),className:"p-2 border border-gray-200 dark:border-gray-700 rounded-lg min-w-[200px] bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100",children:[r.jsx("option",{value:"",disabled:!0,children:"Select License Types"}),c.map((e=>r.jsx("option",{value:e,children:e},e)))]}),r.jsxs("div",{className:"flex flex-col gap-2",children:[r.jsxs("label",{className:"flex items-center gap-2 text-gray-900 dark:text-gray-100",children:[r.jsx("input",{type:"checkbox",checked:d,onChange:e=>m(e.target.checked),className:"rounded border-gray-300 dark:border-gray-600 text-blue-600 focus:ring-blue-500 bg-white dark:bg-gray-800"}),"Show Unknown Licenses"]}),r.jsxs("label",{className:"flex items-center gap-2 text-gray-900 dark:text-gray-100",children:[r.jsx("input",{type:"checkbox",checked:u,onChange:e=>b(e.target.checked),className:"rounded border-gray-300 dark:border-gray-600 text-blue-600 focus:ring-blue-500 bg-white dark:bg-gray-800"}),"Hide Zero Cost Accounts"]})]})]})]})}const _=y(f()),z={"639dec6b-bb19-468b-871c-c5c441c4b0cb":{monthlyPrice:34.6,annualPrice:415.2,description:"M365 Copilot Sub Add-on"},"06ebc4ee-1bb5-47dd-8120-11324bc54e06":{monthlyPrice:30.94,annualPrice:371.28,description:"M365 E5 Unified Existing Customer Sub Per User"},"4b585984-651b-448a-9e53-3b10f069cf7f":{monthlyPrice:0,annualPrice:0,description:"M365 F3 FUSL Sub Per User"},"18181a46-0d4e-45cd-891e-60aabd171b4e":{monthlyPrice:0,annualPrice:0,description:"O365 E1 Existing Customer Sub Per User"},"440eaaa8-b3e0-484b-a8be-62870b9ba70a":{monthlyPrice:0,annualPrice:0,description:"Phone Resource Account Sub Phone System Virtual User"},"5b631642-bd26-49fe-bd20-1daaa972ef80":{monthlyPrice:3.39,annualPrice:40.68,description:"Power Apps Per App Sub 1 App or Website"},"eda1941c-3c4f-4995-b5eb-e85a42175ab9":{monthlyPrice:5.09,annualPrice:61.08,description:"Power Automate Premium Sub Per User"},"53818b1b-4a27-454b-8896-0dba576410e6":{monthlyPrice:13.84,annualPrice:166.08,description:"Project P3 Sub Per User"},"11dee6af-eca8-419f-8061-6864517c1875":{monthlyPrice:8.13,annualPrice:97.56,description:"Teams Domestic Calling Plan Sub (120 Min Per User)"},"52ea0e27-ae73-4983-a08f-13561ebdb823":{monthlyPrice:3.8,annualPrice:45.6,description:"Teams Premium Introductory Pricing Sub Per User"},"6070a4c8-34c6-4937-8dfb-39bbc6397a60":{monthlyPrice:13.57,annualPrice:162.84,description:"Teams Rooms Pro Sub Per Device"},"295a8eb0-f78d-45c7-8b5b-1eed5ed02dff":{monthlyPrice:3.69,annualPrice:44.28,description:"Teams Shared Devices Sub Per Device"},"4b244418-9658-4451-a2b8-b5e2b364e9bd":{monthlyPrice:2.31,annualPrice:27.72,description:"Visio P1 Sub Per User"},"c5928f49-12ba-48f7-ada3-0d743a3601d5":{monthlyPrice:6.92,annualPrice:83.04,description:"Visio P2 Sub Per User"},"2880026b-2b0c-4251-8656-5d41ff11e3aa":{monthlyPrice:120,annualPrice:1440,description:"SR365 Full"},"7ac9fe77-66b7-4e5e-9e46-10eed1cff547":{monthlyPrice:3,annualPrice:36,description:"SR365 Teams"},"9a1e33ed-9697-43f3-b84c-1b0959dbb1d4":{monthlyPrice:15.42,annualPrice:185,description:"SR365 Manager"}},W={"e43b5b99-8dfb-405f-9987-dc307f34bcbd":"MICROSOFT 365 PHONE SYSTEM","9a1e33ed-9697-43f3-b84c-1b0959dbb1d4":"SR365 Manager","06ebc4ee-1bb5-47dd-8120-11324bc54e06":"Microsoft 365 E5","1e1a282c-9c54-43a2-9310-98ef728faace":"DYNAMICS 365 FOR SALES ENTERPRISE EDITION","11dee6af-eca8-419f-8061-6864517c1875":"MICROSOFT 365 DOMESTIC CALLING PLAN (120 Minutes)","f30db892-07e9-47e9-837c-80727f46fd3d":"MICROSOFT FLOW FREE","2880026b-2b0c-4251-8656-5d41ff11e3aa":"SR365 Full","2e3c4023-80f6-4711-aa5d-29e0ecb46835":"AZURE ACTIVE DIRECTORY PREMIUM P1","a403ebcc-fae0-4ca2-8c8c-7a907fd6c235":"Power BI (free)","53818b1b-4a27-454b-8896-0dba576410e6":"Project Plan 3","639dec6b-bb19-468b-871c-c5c441c4b0cb":"Copilot for Microsoft 365","18181a46-0d4e-45cd-891e-60aabd171b4e":"OFFICE 365 E1","4b585984-651b-448a-9e53-3b10f069cf7f":"OFFICE 365 F3","5b631642-bd26-49fe-bd20-1daaa972ef80":"Microsoft Power Apps for Developer","4b244418-9658-4451-a2b8-b5e2b364e9bd":"VISIO ONLINE PLAN 1","c5928f49-12ba-48f7-ada3-0d743a3601d5":"VISIO ONLINE PLAN 2","47794cd0-f0e5-45c5-9033-2eb6b5fc84e0":"COMMUNICATIONS CREDITS","440eaaa8-b3e0-484b-a8be-62870b9ba70a":"Microsoft Teams Phone Resource Account","eda1941c-3c4f-4995-b5eb-e85a42175ab9":"Power Automate Premium","3f9f06f5-3c31-472c-985f-62d9c10ec167":"Power Pages vTrial for Makers","606b54a9-78d8-4298-ad8b-df6ef4481c80":"Power Virtual Agents Viral Trial","238e2f8d-e429-4035-94db-6926be4ffe7b":"Dynamics 365 for Marketing Business Edition","52ea0e27-ae73-4983-a08f-13561ebdb823":"Teams Premium (for Departments)","295a8eb0-f78d-45c7-8b5b-1eed5ed02dff":"Microsoft Teams Shared Devices","6070a4c8-34c6-4937-8dfb-39bbc6397a60":"Microsoft Teams Rooms Standard","7ac9fe77-66b7-4e5e-9e46-10eed1cff547":"SR365 Teams"},J=e=>{let r=0,t=0,a=0;return Object.values(e).forEach((e=>{r+=e.length,e.forEach((e=>{e.licenses.forEach((e=>{var r,n;t+=(null==(r=z[e.guid])?void 0:r.monthlyPrice)||0,a+=(null==(n=z[e.guid])?void 0:n.annualPrice)||0}))}))})),{users:r,monthly:t,annual:a}},K=e=>{if(!e)return"No Department";if("onfrontdoor"===(e=e.trim()).toLowerCase())return"ON";if(e.includes("Contractor - SK - NetResults"))return"SK";if(e.includes("Instructor- FD")||e.includes("Instructor - FD"))return"FD";if(e.includes("Generic - IT"))return"NHQ";if(e.toUpperCase().startsWith("X-")){const r=e.substring(2).toUpperCase();if(["AB","BCY","MB","NB","NL-LAB","NS-PEI","ON","QC","SK","FD"].includes(r))return r;if("NHQ"===r)return"NHQ"}const r=e.split(" - ");if(r.length>=2){const e=r[r.length-1].toUpperCase();if(["AB","BCY","MB","NB","NL-LAB","NS-PEI","ON","QC","SK","FD"].includes(e))return e;if("NHQ"===e||r.includes("NHQ"))return"NHQ"}return e};function Q(e,r){const t=x.book_new(),a=function(e){return[["Department","Total Users","Monthly Cost","Annual Cost"],...Object.entries(e).map((([e,r])=>{const t=r.reduce(((e,r)=>({monthly:e.monthly+r.licenses.reduce(((e,r)=>{var t;return e+((null==(t=z[r.guid])?void 0:t.monthlyPrice)||0)}),0),annual:e.annual+r.licenses.reduce(((e,r)=>{var t;return e+((null==(t=z[r.guid])?void 0:t.annualPrice)||0)}),0)})),{monthly:0,annual:0});return[e,r.length,t.monthly.toFixed(2),t.annual.toFixed(2)]}))]}(e);a.push([]),a.push([r]);const n=x.aoa_to_sheet(a);return x.book_append_sheet(t,n,"Summary"),Object.entries(e).forEach((([e,a])=>{const n=new Set;a.forEach((e=>{e.licenses.forEach((e=>{["AAD P1","Communications Credits","Microsoft 365 Phone System","Microsoft Flow Free","Microsoft Teams Shared Devices","Microsoft Teams Rooms Standard","Power BI (free)","Power Pages vTrial for Makers","Power Virtual Agents Viral Trial"].includes(e.productName)||n.add(e.productName)}))}));const s=[["Display Name","Email","Monthly Cost","Annual Cost",...Array.from(n)],...a.map((e=>[e.displayName,e.userPrincipalName,e.licenses.reduce(((e,r)=>{var t;return e+((null==(t=z[r.guid])?void 0:t.monthlyPrice)||0)}),0).toFixed(2),e.licenses.reduce(((e,r)=>{var t;return e+((null==(t=z[r.guid])?void 0:t.annualPrice)||0)}),0).toFixed(2),...Array.from(n).map((r=>e.licenses.some((e=>e.productName===r))?"X":""))]))];s.push([]),s.push([r]);const o=x.aoa_to_sheet(s);x.book_append_sheet(t,o,e.slice(0,31))})),t}const Y=(e,r,t=!1)=>{let a=function(e){return`\n    <!DOCTYPE html>\n    <html lang="en">\n    <head>\n      <meta charset="UTF-8">\n      <meta name="viewport" content="width=device-width, initial-scale=1.0">\n      <title>SJA Office 365 License Report</title>\n      <style>${e}</style>\n    </head>\n    <body>\n      <div class="container">\n        <header class="header">\n          <img src="https://www.clipartmax.com/png/full/77-773552_ambulance-clipart-images.png" alt="SJA Logo" class="logo" />\n          <h1>SJA Office 365 License Report</h1>\n        </header>\n        <div class="content">\n  `}("\n     :root {\n      --primary-color: #2563eb;\n      --success-color: #059669;\n    }\n\n    * {\n      margin: 0;\n      padding: 0;\n      box-sizing: border-box;\n    }\n\n    body {\n      font-family: 'Lato', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Helvetica, sans-serif;\n      line-height: 1.5;\n      color: #f9fafb;\n      background-color: #f9fafb;\n      min-height: 100vh;\n      display: flex;\n      flex-direction: column;\n    }\n\n    h1, h2, h3, h4, h5, h6 {\n      font-family: 'Nunito Sans', sans-serif;\n    }\n\n    .container {\n      max-width: 100%;\n      margin: 0 auto;\n      padding: 2rem;\n      flex: 1;\n    }\n\n    .header {\n      position: sticky;\n      top: 0;\n      background-color: white;\n      padding: 1.5rem;\n      margin-bottom: 2rem;\n      border-bottom: 1px solid #e5e7eb;\n      z-index: 10;\n      display: flex;\n      align-items: center;\n      justify-content: space-between;\n    }\n\n    .logo {\n      height: 50px;\n      margin-right: 1rem;\n    }\n\n    .content {\n      display: flex;\n      flex-direction: column;\n      gap: 2rem;\n    }\n\n    .card {\n      background-color: white;\n      border-radius: 0.5rem;\n      box-shadow: 0 1px 3px rgba(0, 0, 0, 0.3);\n      overflow: hidden;\n    }\n\n    .table-container {\n      overflow-x: auto;\n      max-width: 100%;\n    }\n\n    table {\n      width: 100%;\n      border-collapse: collapse;\n      font-size: 0.875rem;\n    }\n\n    th, td {\n      padding: 0.75rem 1rem;\n      text-align: left;\n      border: 1px solid #e5e7eb;\n    }\n\n    th {\n      background-color: #f9fafb;\n      font-weight: 600;\n      white-space: nowrap;\n    }\n\n    tr:hover {\n      background-color: #f9fafb;\n    }\n\n    .summary-grid {\n      display: grid;\n      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));\n      gap: 1rem;\n      padding: 1.5rem;\n    }\n\n    .summary-box {\n      padding: 1.5rem;\n      border-radius: 0.5rem;\n      text-align: center;\n    }\n\n    .summary-box.total-users { background-color: #f3f4f6; }\n    .summary-box.monthly { background-color: #eff6ff; }\n    .summary-box.annual { background-color: #ecfdf5; }\n\n    @media (max-width: 600px) {\n      body {\n        font-size: 0.75rem;\n      }\n\n      th, td {\n        padding: 0.5rem 0.75rem;\n      }\n\n      .summary-box {\n        padding: 1rem;\n      }\n    }\n\n    @media (min-width: 601px) and (max-width: 1200px) {\n      body {\n        font-size: 0.875rem;\n      }\n\n      th, td {\n        padding: 0.75rem 1rem;\n      }\n\n      .summary-box {\n        padding: 1.25rem;\n      }\n    }\n\n    @media (min-width: 1201px) {\n      body {\n        font-size: 1rem;\n      }\n\n      th, td {\n        padding: 1rem 1.25rem;\n      }\n\n      .summary-box {\n        padding: 1.5rem;\n      }\n    }\n\n    @media print {\n      @page {\n        size: auto;\n        margin: 0.5in;\n      }\n\n      body {\n        background: white;\n        min-height: 0 !important;\n        padding: 0 !important;\n      }\n\n      .header {\n        position: static;\n        break-after: avoid;\n      }\n\n      .card {\n        break-inside: avoid;\n        box-shadow: none;\n        border: 1px solid #e5e7eb;\n        margin: 1rem 0;\n        page-break-inside: avoid;\n      }\n\n      .table-container {\n        overflow: visible;\n      }\n\n      table {\n        font-size: 9pt;\n        page-break-inside: auto;\n      }\n\n      tr {\n        page-break-inside: avoid;\n      }\n\n      th, td {\n        padding: 4px 8px;\n      }\n\n      /* Avoid blank pages */\n      .content {\n        display: block;\n      }\n\n      /* Hide print button when printing */\n      #printButton {\n        display: none !important;\n      }\n    }\n  ");const n=new Set;Object.values(e).forEach((e=>{e.forEach((e=>{e.licenses.forEach((e=>{["AAD P1","Communications Credits","Microsoft 365 Phone System","Microsoft Flow Free","Microsoft Teams Shared Devices","Microsoft Teams Rooms Standard","Power BI (free)","Power Pages vTrial for Makers","Power Virtual Agents Viral Trial"].includes(e.productName)||n.add(e.productName)}))}))}));const s=650+150*n.size;return a=a.replace("{{ tableWidth }}",s.toString()),a+=function(e){const r=new Set,t={};return Object.values(e).forEach((e=>{e.forEach((e=>{e.licenses.forEach((e=>{var a,n;r.add(e.productName),t[e.productName]||(t[e.productName]={users:0,monthlyTotal:0,annualTotal:0}),t[e.productName].users++,t[e.productName].monthlyTotal+=(null==(a=z[e.guid])?void 0:a.monthlyPrice)||0,t[e.productName].annualTotal+=(null==(n=z[e.guid])?void 0:n.annualPrice)||0}))}))})),`\n    <div class="card" style="page-break-after: auto;">\n      <div class="card-header">\n        <h2>License Summary</h2>\n      </div>\n      <div class="table-container">\n        <table>\n          <thead>\n            <tr>\n              <th>License Type</th>\n              <th>Users</th>\n              <th>Monthly Cost</th>\n              <th>Annual Cost</th>\n            </tr>\n          </thead>\n          <tbody>\n            ${Array.from(r).map((e=>`\n              <tr>\n                <td>${e}</td>\n                <td>${t[e].users}</td>\n                <td>$${t[e].monthlyTotal.toFixed(2)}</td>\n                <td>$${t[e].annualTotal.toFixed(2)}</td>\n              </tr>\n            `)).join("")}\n          </tbody>\n        </table>\n      </div>\n    </div>\n  `}(e),a+=function(e,r,t){return`\n    <div class="card" style="page-break-after: auto;">\n      <div class="card-header">\n        <h2>License Mapping</h2>\n      </div>\n      <div class="table-container">\n        <table style="page-break-inside: auto;">\n          <thead>\n            <tr>\n              <th>Display Name</th>\n              <th>Email</th>\n              <th>Department</th>\n              <th>Monthly Cost</th>\n              <th>Annual Cost</th>\n              ${t?"<th>Assigned Licenses</th>":r.map((e=>`<th>${e}</th>`)).join("")}\n            </tr>\n          </thead>\n          <tbody>\n            ${Object.entries(e).flatMap((([,e])=>e.map((e=>`\n                <tr>\n                  <td>${e.displayName}</td>\n                  <td>${e.userPrincipalName}</td>\n                  <td>${e.originalDepartment}</td>\n                  <td>$${e.licenses.reduce(((e,r)=>{var t;return e+((null==(t=z[r.guid])?void 0:t.monthlyPrice)||0)}),0).toFixed(2)}</td>\n                  <td>$${e.licenses.reduce(((e,r)=>{var t;return e+((null==(t=z[r.guid])?void 0:t.annualPrice)||0)}),0).toFixed(2)}</td>\n                  ${t?`<td>${e.licenses.map((e=>e.productName)).join(", ")}</td>`:r.map((r=>`<td>${e.licenses.some((e=>e.productName===r))?"X":""}</td>`)).join("")}\n                </tr>\n              `)).join(""))).join("")}\n          </tbody>\n        </table>\n      </div>\n    </div>\n  `}(e,Array.from(n),t),a+=function(e){const r=J(e);return`\n    <div class="card" style="page-break-inside: avoid;">\n      <div class="card-header">\n        <h2>Total Summary</h2>\n      </div>\n      <div class="summary-grid">\n        <div class="summary-box total-users">\n          <h3>Total Users</h3>\n          <div class="value">${r.users}</div>\n        </div>\n        <div class="summary-box monthly">\n          <h3>Monthly Cost</h3>\n          <div class="value">$${r.monthly.toFixed(2)}</div>\n          <div class="per-user">$${(r.monthly/r.users).toFixed(2)} per user</div>\n        </div>\n        <div class="summary-box annual">\n          <h3>Annual Cost</h3>\n          <div class="value">$${r.annual.toFixed(2)}</div>\n          <div class="per-user">$${(r.annual/r.users).toFixed(2)} per user</div>\n        </div>\n      </div>\n    </div>\n  `}(e),a+=`<div class="branding">${r}</div>`,a+="\n        </div>\n      </div>\n      <script>\n        // Add print button\n        const printButton = document.createElement('button');\n        printButton.id = 'printButton';\n        printButton.innerText = 'Print Report';\n        printButton.style.cssText = 'position:fixed;bottom:20px;right:20px;padding:10px 20px;background:#2563eb;color:white;border:none;border-radius:5px;cursor:pointer;z-index:1000;';\n        printButton.onclick = () => {\n          // Remove the button before printing\n          printButton.style.display = 'none';\n          window.print();\n          // Show the button again after printing\n          setTimeout(() => printButton.style.display = 'block', 100);\n        };\n        document.body.appendChild(printButton);\n      <\/script>\n    </body>\n    </html>\n  ",a};const Z=y(v());class G extends Error{constructor(e,r,t){super(e),this.code=r,this.details=t,this.name="LicenseError"}}const X="FILE_PARSE_ERROR";function q(){const[r,t]=e.useState({}),[a,n]=e.useState(!1),[s,o]=e.useState(""),[l,i]=e.useState(null),c=async e=>{if(!e)return o(""),void t({});n(!0);try{const r=await e.text(),a=_.parse(r,{header:!0,skipEmptyLines:!0,transformHeader:e=>e.trim(),transform:e=>e.trim()});if(a.errors.length>0)throw new Error("Error parsing CSV: "+a.errors[0].message);const n=function(e){return e.filter((e=>{var r;return!(null==(r=e.Department)?void 0:r.startsWith("X-"))})).map((e=>{return{displayName:e.DisplayName,userPrincipalName:e.UserPrincipalName,department:K(e.Department),originalDepartment:e.Department||"No Department",licenses:(r=e.Licenses,r?r.toLowerCase().split(/[\s,]+/).map((e=>e.trim())).filter((e=>e.match(/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/))).map((e=>({guid:e,productName:W[e]||"Unknown License"}))).map((e=>{switch(e.productName){case"Microsoft 365 E5":e.productName="M365 E5";break;case"Office 365 E1":e.productName="O365 E1";break;case"Office 365 F3":e.productName="O365 F3";break;case"Azure Active Directory Premium P1":e.productName="AAD P1";break;case"Dynamics 365":e.productName="D365"}return e})):[]).map((e=>{switch(e.productName){case"Microsoft 365 E5":e.productName="M365 E5";break;case"Office 365 E1":e.productName="O365 E1";break;case"Office 365 F3":e.productName="O365 F3";break;case"Azure Active Directory Premium P1":e.productName="AAD P1";break;case"Dynamics 365":e.productName="D365"}return e}))};var r}))}(a.data),s=Z.groupBy(n,"department"),l=Z.mapValues(s,(e=>Z.sortBy(e,["displayName"])));t(l),o(e.name)}catch(r){const e=new G("Error loading file",X,r);i(e)}finally{n(!1)}},d=e.useCallback((async e=>{var r;const t=null==(r=e.target.files)?void 0:r[0];t&&await c(t)}),[]),m=e.useCallback((async e=>{var r;e.preventDefault();const t=null==(r=e.dataTransfer.files)?void 0:r[0];t&&await c(t)}),[]);return{groupedData:r,loading:a,fileName:s,error:l,setError:i,handleFileUpload:d,handleFileDrop:m}}function ee(e){const r=((e,r)=>{const t=[];t.push(["Department","Display Name","Email","Original Department","Licenses","Monthly Cost","Annual Cost"]),Object.entries(e).forEach((([e,r])=>{r.forEach((r=>{const a=r.licenses.reduce(((e,r)=>{var t;return e+((null==(t=z[r.guid])?void 0:t.monthlyPrice)||0)}),0),n=r.licenses.reduce(((e,r)=>{var t;return e+((null==(t=z[r.guid])?void 0:t.annualPrice)||0)}),0);t.push([e,r.displayName,r.userPrincipalName,r.originalDepartment,r.licenses.map((e=>e.productName)).join("; "),a.toFixed(2),n.toFixed(2)])}))}));const a=J(e);return t.push([]),t.push(["GRAND TOTALS",`Total Users: ${a.users}`,"","","",a.monthly.toFixed(2),a.annual.toFixed(2)]),t.push([]),t.push([r]),_.unparse(t)})(e,"St John Ambulance Canada"),t=new Blob([r],{type:"text/csv;charset=utf-8;"}),a=document.createElement("a");a.href=URL.createObjectURL(t),a.download="license_report.csv",a.click()}const re=new Intl.NumberFormat("en-CA",{style:"currency",currency:"CAD",minimumFractionDigits:2,maximumFractionDigits:2}),te=e.memo((({userRows:t,licenseColumns:a,sortState:n,onSort:s})=>{const o=e.useCallback((e=>{s({column:e,direction:n.column===e&&"asc"===n.direction?"desc":"asc"})}),[n,s]),l=e.useCallback((({column:e})=>n.column!==e?null:"asc"===n.direction?r.jsx(i,{className:"w-4 h-4 inline-block ml-1"}):r.jsx(c,{className:"w-4 h-4 inline-block ml-1"})),[n]),g=e.useMemo((()=>r.jsxs("tr",{children:[r.jsx("th",{onClick:()=>o("displayName"),className:d("p-2 border border-gray-200 dark:border-gray-700 text-left bg-gray-50 dark:bg-gray-800 text-gray-900 dark:text-gray-100 font-semibold cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-700","displayName"===n.column&&"bg-blue-50 dark:bg-blue-900"),children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("span",{children:"Display Name"}),r.jsx(l,{column:"displayName"})]})}),r.jsx("th",{onClick:()=>o("userPrincipalName"),className:d("p-2 border border-gray-200 dark:border-gray-700 text-left bg-gray-50 dark:bg-gray-800 text-gray-900 dark:text-gray-100 font-semibold cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-700","userPrincipalName"===n.column&&"bg-blue-50 dark:bg-blue-900"),children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("span",{children:"Email"}),r.jsx(l,{column:"userPrincipalName"})]})}),r.jsx("th",{onClick:()=>o("department"),className:d("p-2 border border-gray-200 dark:border-gray-700 text-left bg-gray-50 dark:bg-gray-800 text-gray-900 dark:text-gray-100 font-semibold cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-700","department"===n.column&&"bg-blue-50 dark:bg-blue-900"),children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("span",{children:"Department"}),r.jsx(l,{column:"department"})]})}),r.jsx("th",{onClick:()=>o("totalMonthlyCost"),className:d("p-2 border border-gray-200 dark:border-gray-700 text-left bg-gray-50 dark:bg-gray-800 text-gray-900 dark:text-gray-100 font-semibold cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-700","totalMonthlyCost"===n.column&&"bg-blue-50 dark:bg-blue-900"),children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("span",{children:"Monthly Cost"}),r.jsx(l,{column:"totalMonthlyCost"})]})}),r.jsx("th",{onClick:()=>o("totalAnnualCost"),className:d("p-2 border border-gray-200 dark:border-gray-700 text-left bg-gray-50 dark:bg-gray-800 text-gray-900 dark:text-gray-100 font-semibold cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-700","totalAnnualCost"===n.column&&"bg-blue-50 dark:bg-blue-900"),children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("span",{children:"Annual Cost"}),r.jsx(l,{column:"totalAnnualCost"})]})}),a.map((e=>r.jsx("th",{className:"p-2 border border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-800 text-gray-900 dark:text-gray-100",title:`${e.name} (${t.filter((r=>r.licenses.some((r=>r.productName===e.name)))).length} users)`,children:e.name},e.key)))]})),[n,o,l,a,t]),p=e.useMemo((()=>t.map(((e,t)=>r.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700",children:[r.jsx("td",{className:"p-2 border border-gray-200 dark:border-gray-700 text-gray-900 dark:text-gray-100",children:e.displayName}),r.jsx("td",{className:"p-2 border border-gray-200 dark:border-gray-700 text-gray-900 dark:text-gray-100",children:e.userPrincipalName}),r.jsx("td",{className:"p-2 border border-gray-200 dark:border-gray-700 text-gray-900 dark:text-gray-100",children:e.department}),r.jsx("td",{className:"p-2 border border-gray-200 dark:border-gray-700 text-gray-900 dark:text-gray-100 text-right",children:re.format(e.totalMonthlyCost??0)}),r.jsx("td",{className:"p-2 border border-gray-200 dark:border-gray-700 text-gray-900 dark:text-gray-100 text-right",children:re.format(e.totalAnnualCost??0)}),a.map((t=>r.jsx("td",{className:"p-2 border border-gray-200 dark:border-gray-700 text-center text-gray-900 dark:text-gray-100",children:r.jsx("div",{className:"flex items-center justify-center",children:e.licenses.some((e=>e.productName===t.name))?"✓":""})},t.key)))]},t)))),[t,a]);return r.jsxs(m,{className:"w-full bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700",children:[r.jsx(u,{className:"bg-gray-50 dark:bg-gray-800 rounded-t-lg border-b border-gray-200 dark:border-gray-700",children:r.jsx(b,{className:"text-center text-gray-900 dark:text-gray-100",children:"License Mapping"})}),r.jsx(h,{className:"p-6",children:r.jsx("div",{className:"overflow-auto max-h-[600px] scrollbar scrollbar-w-4 hover:scrollbar-w-5 scrollbar-thumb-gray-400 hover:scrollbar-thumb-gray-500 dark:scrollbar-thumb-gray-500 dark:hover:scrollbar-thumb-gray-400 scrollbar-track-transparent hover:scrollbar-track-gray-200 dark:hover:scrollbar-track-gray-800 transition-all duration-100",children:r.jsxs("table",{className:"w-full border-collapse min-w-[800px] border border-gray-200 dark:border-gray-700",children:[r.jsx("thead",{className:"sticky top-0 z-10",children:g}),r.jsx("tbody",{children:p})]})})})]})}));function ae({defaultColumn:r="",defaultDirection:t="asc"}={}){const[a,n]=e.useState({column:r,direction:t});return{sortState:a,handleSort:e.useCallback((e=>{n((r=>({column:e,direction:r.column===e&&"asc"===r.direction?"desc":"asc"})))}),[])}}const ne=(e,r)=>null==e&&null==r?0:null==e?-1:null==r?1:"number"==typeof e&&"number"==typeof r?e-r:"string"==typeof e&&"string"==typeof r?e.toLowerCase().localeCompare(r.toLowerCase()):String(e).toLowerCase().localeCompare(String(r).toLowerCase()),se=(e,r)=>{switch(r){case"displayName":case"userPrincipalName":case"department":return e[r];case"totalMonthlyCost":case"totalAnnualCost":return e[r]||0;default:return null}},oe="/reconciliation/",le=("/reconciliation/".includes("github.io"),()=>{const{groupedData:t,loading:a,fileName:n,error:s,setError:l,handleFileUpload:g,handleFileDrop:p}=q(),{sortState:y,handleSort:f}=ae({defaultColumn:"displayName",defaultDirection:"asc"}),{sortState:x,handleSort:v}=ae({defaultColumn:"totalUsers",defaultDirection:"desc"}),[N,w]=e.useState(""),[j,C]=e.useState([]),[P,S]=e.useState([]),[A,E]=e.useState(!1),[M,T]=e.useState(!1),L=e.useMemo((()=>Object.keys(t).sort()),[t]),D=e.useMemo((()=>{const e=new Set;return Object.values(t).forEach((r=>{r.forEach((r=>{r.licenses.forEach((r=>{e.add(r.productName)}))}))})),Array.from(e).sort()}),[t]),O=e.useMemo((()=>{const e={...t};return function(e,r){r.length>0&&Object.keys(e).forEach((t=>{r.includes(t)||delete e[t]}))}(e,j),function(e,r,t,a,n){Object.keys(e).forEach((s=>{e[s]=e[s].filter((e=>{const s=""===r||e.displayName.toLowerCase().includes(r.toLowerCase())||e.userPrincipalName.toLowerCase().includes(r.toLowerCase())||e.originalDepartment.toLowerCase().includes(r.toLowerCase()),o=0===t.length||e.licenses.some((e=>t.includes(e.productName))),l=!!a||!e.licenses.some((e=>"Unknown License"===e.productName)),i=e.licenses.reduce(((e,r)=>{var t;return e+((null==(t=z[r.guid])?void 0:t.monthlyPrice)||0)}),0),c=e.licenses.reduce(((e,r)=>{var t;return e+((null==(t=z[r.guid])?void 0:t.annualPrice)||0)}),0);return s&&o&&l&&(!n||i>0||c>0)}))}))}(e,N,P,A,M),e}),[t,N,j,P,A,M]),F=e.useMemo((()=>J(O)),[O]),R=e.useCallback((e=>{try{switch(e){case"pdf":!function(e){const r=Y(e,"true",!0),t=new Blob([r],{type:"text/html"}),a=URL.createObjectURL(t),n=document.createElement("iframe");n.style.display="none",document.body.appendChild(n),n.onload=()=>{var e;null==(e=n.contentWindow)||e.print(),URL.revokeObjectURL(a),setTimeout((()=>{document.body.removeChild(n)}),100)},n.src=a}(O);break;case"csv":ee(O);break;case"excel":!function(e){const r=Q(e,"St John Ambulance Canada");k(r,"license_report.xlsx")}(O);break;case"html":!function(e){const r=Y(e,"true"),t=new Blob([r],{type:"text/html;charset=utf-8;"}),a=document.createElement("a");a.href=URL.createObjectURL(t),a.download="license_report.html",a.click()}(O)}}catch(r){alert("Error exporting file. Please try again.")}}),[O]),U=e.useMemo((()=>((e,r)=>{const{column:t,direction:a}=r;return t&&a?[...e].sort(((e,r)=>{const n=se(e,t),s=se(r,t),o=ne(n,s);return"asc"===a?o:-o})):e})(Object.entries(O).flatMap((([,e])=>e.map((e=>({...e,department:e.originalDepartment,totalMonthlyCost:e.licenses.reduce(((e,r)=>{var t;return e+((null==(t=z[r.guid])?void 0:t.monthlyPrice)||0)}),0),totalAnnualCost:e.licenses.reduce(((e,r)=>{var t;return e+((null==(t=z[r.guid])?void 0:t.annualPrice)||0)}),0)}))))),y)),[O,y]),_=e.useMemo((()=>[...D.map((e=>{const r=U.filter((r=>r.licenses.some((r=>r.productName===e)))).length,t=U.reduce(((r,t)=>r+t.licenses.filter((r=>r.productName===e)).reduce(((e,r)=>{var t;return e+((null==(t=z[r.guid])?void 0:t.monthlyPrice)||0)}),0)),0),a=U.reduce(((r,t)=>r+t.licenses.filter((r=>r.productName===e)).reduce(((e,r)=>{var t;return e+((null==(t=z[r.guid])?void 0:t.annualPrice)||0)}),0)),0);return{type:e,totalUsers:r,totalMonthlyCost:t,totalAnnualCost:a}})).filter((e=>!["AAD P1","Communications Credits","Microsoft 365 Phone System","AZURE ACTIVE DIRECTORY PREMIUM P1","MICROSOFT FLOW FREE","Microsoft Teams Shared Devices","Microsoft Teams Rooms Standard","Power BI (free)","Power Pages vTrial for Makers","Power Virtual Agents Viral Trial","Power Automate Premium"].includes(e.type)))].sort(((e,r)=>{const t="asc"===x.direction?1:-1,a=e[x.column],n=r[x.column];return t*ne(a,n)}))),[U,D,x]),W=e.useMemo((()=>{const e=D.reduce(((e,r)=>(e[r]=U.filter((e=>e.licenses.some((e=>e.productName===r)))).length,e)),{});return D.filter((e=>!["AAD P1","Communications Credits","Microsoft 365 Phone System","AZURE ACTIVE DIRECTORY PREMIUM P1","MICROSOFT FLOW FREE","Microsoft Teams Shared Devices","Microsoft Teams Rooms Standard","Power BI (free)","Power Pages vTrial for Makers","Power Virtual Agents Viral Trial","Power Automate Premium"].includes(e))).map((r=>({key:r,name:r,usageCount:e[r]||0}))).sort(((e,r)=>r.usageCount-e.usageCount)).map((({key:e,name:r})=>({key:e,name:r})))}),[D,U]),K=e=>new Intl.NumberFormat("en-CA",{style:"currency",currency:"CAD",minimumFractionDigits:2,maximumFractionDigits:2}).format(e);return s?r.jsx("div",{className:"flex items-center justify-center h-screen w-screen bg-white dark:bg-gray-900",children:r.jsxs("div",{className:"text-red-600 dark:text-red-400",children:[r.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Error"}),r.jsx("p",{children:s.message}),r.jsx("button",{onClick:()=>l(null),className:"mt-4 px-4 py-2 bg-red-600 text-white dark:bg-red-500 dark:hover:bg-red-600 rounded",children:"Dismiss"})]})}):a?r.jsx("div",{className:"flex items-center justify-center h-screen w-screen bg-white dark:bg-gray-900",children:r.jsx("div",{className:"text-3xl font-bold text-gray-600 dark:text-gray-300",children:"Loading license data..."})}):r.jsx(I,{attribute:"class",defaultTheme:"system",enableSystem:!0,children:r.jsxs("div",{className:"h-screen w-screen flex flex-col overflow-hidden bg-white dark:bg-gray-900 text-gray-900 dark:text-gray-100",children:[r.jsx("div",{className:"flex-none bg-white dark:bg-gray-900 border-b border-gray-200 dark:border-gray-800 shadow-sm",children:r.jsxs("div",{className:"p-4",children:[r.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center gap-4",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("img",{src:`${oe}sjalogo.png`,alt:"Company Logo",className:"w-10 h-10"}),r.jsx("h1",{className:"text-2xl font-bold",children:"SJA Office 365 License Mapping"})]}),r.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[r.jsx(V,{onFileUpload:g,fileName:n}),r.jsx(B,{fileName:n,onExport:R}),r.jsx($,{})]})]}),n&&r.jsx(H,{searchTerm:N,onSearchChange:w,selectedDepartments:j,onDepartmentChange:C,departments:L,selectedLicenseTypes:P,onLicenseTypesChange:S,licenseTypes:D,showUnknownLicenses:A,onShowUnknownLicensesChange:E,hideZeroCostAccounts:M,onHideZeroCostAccountsChange:T})]})}),r.jsx("div",{className:"flex-1 min-h-0 w-full overflow-auto bg-gray-50 dark:bg-gray-900",onDrop:p,onDragOver:e=>{e.preventDefault()},children:r.jsx("div",{className:"h-full p-4",children:n?r.jsxs("div",{className:"flex flex-col gap-4",children:[r.jsxs(m,{className:"w-full bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700",children:[r.jsx(u,{className:"bg-gray-50 dark:bg-gray-800 rounded-t-lg border-b border-gray-200 dark:border-gray-700",children:r.jsx(b,{className:"text-center",children:"License Price Summary"})}),r.jsx(h,{className:"p-6",children:r.jsx("div",{className:"overflow-x-auto",children:r.jsxs("table",{className:"w-full border-collapse min-w-[800px] border border-gray-200 dark:border-gray-700",children:[r.jsx("thead",{className:"bg-white dark:bg-gray-700",children:r.jsxs("tr",{children:[r.jsx("th",{onClick:()=>v("type"),className:d("p-2 border text-left bg-gray-50 dark:bg-gray-800 font-semibold cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-600","type"===x.column&&"bg-blue-50 dark:bg-blue-900"),children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("span",{children:"License Type"}),"type"===x.column&&("asc"===x.direction?r.jsx(i,{className:"w-4 h-4 text-blue-600"}):r.jsx(c,{className:"w-4 h-4 text-blue-600"}))]})}),r.jsx("th",{onClick:()=>v("totalUsers"),className:d("p-2 border text-left bg-gray-50 dark:bg-gray-800 font-semibold cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-600","totalUsers"===x.column&&"bg-blue-50 dark:bg-blue-900"),children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("span",{children:"Total Users"}),"totalUsers"===x.column&&("asc"===x.direction?r.jsx(i,{className:"w-4 h-4 text-blue-600"}):r.jsx(c,{className:"w-4 h-4 text-blue-600"}))]})}),r.jsx("th",{onClick:()=>v("totalMonthlyCost"),className:d("p-2 border text-left bg-gray-50 dark:bg-gray-800 font-semibold cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-600","totalMonthlyCost"===x.column&&"bg-blue-50 dark:bg-blue-900"),children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("span",{children:"Total Monthly Cost"}),"totalMonthlyCost"===x.column&&("asc"===x.direction?r.jsx(i,{className:"w-4 h-4 text-blue-600"}):r.jsx(c,{className:"w-4 h-4 text-blue-600"}))]})}),r.jsx("th",{onClick:()=>v("totalAnnualCost"),className:d("p-2 border text-left bg-gray-50 dark:bg-gray-800 font-semibold cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-600","totalAnnualCost"===x.column&&"bg-blue-50 dark:bg-blue-900"),children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("span",{children:"Total Annual Cost"}),"totalAnnualCost"===x.column&&("asc"===x.direction?r.jsx(i,{className:"w-4 h-4 text-blue-600"}):r.jsx(c,{className:"w-4 h-4 text-blue-600"}))]})})]})}),r.jsx("tbody",{children:_.map(((e,t)=>r.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-600",children:[r.jsx("td",{className:"p-2 border border-gray-200 dark:border-gray-700",children:e.type}),r.jsx("td",{className:"p-2 border border-gray-200 dark:border-gray-700",children:e.totalUsers}),r.jsx("td",{className:"p-2 border border-gray-200 dark:border-gray-700 text-right",children:K(e.totalMonthlyCost)}),r.jsx("td",{className:"p-2 border border-gray-200 dark:border-gray-700 text-right",children:K(e.totalAnnualCost)})]},t)))})]})})})]}),r.jsx(te,{userRows:U,licenseColumns:W,sortState:y,onSort:e=>f(e.column)}),r.jsxs(m,{className:"w-full bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 shadow-lg",children:[r.jsx(u,{className:"bg-gradient-to-r from-[#1e6759] via-[#0f714b] to-[#007a3d] border-b border-gray-200 dark:border-gray-700",children:r.jsx(b,{className:"text-center text-white",children:"License Summary"})}),r.jsx(h,{className:"p-6",children:r.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-6",children:[r.jsxs("div",{className:"text-center p-4 bg-gray-50 dark:bg-gray-700 rounded-lg shadow-sm hover:shadow-md transition-shadow",children:[r.jsx("div",{className:"text-lg font-semibold text-gray-700 dark:text-gray-100",children:"Total Users"}),r.jsx("div",{className:"text-4xl font-bold mt-2",children:F.users.toLocaleString()})]}),r.jsxs("div",{className:"text-center p-4 bg-gray-50 dark:bg-gray-700 rounded-lg shadow-sm hover:shadow-md transition-shadow",children:[r.jsx("div",{className:"text-lg font-semibold text-gray-700 dark:text-gray-100",children:"Monthly Cost"}),r.jsx("div",{className:"text-4xl font-bold mt-2 text-gray-700 dark:text-gray-100",children:K(F.monthly)}),r.jsxs("div",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:[K(F.monthly/U.filter((e=>e.totalMonthlyCost&&e.totalMonthlyCost>0)).length)," per user"]})]}),r.jsxs("div",{className:"text-center p-4 bg-gray-50 dark:bg-gray-700 rounded-lg shadow-sm hover:shadow-md transition-shadow",children:[r.jsx("div",{className:"text-lg font-semibold text-gray-700 dark:text-gray-100",children:"Annual Cost"}),r.jsx("div",{className:"text-4xl font-bold mt-2 text-gray-700 dark:text-gray-100",children:K(F.annual)}),r.jsxs("div",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:[K(F.annual/U.filter((e=>e.totalAnnualCost&&e.totalAnnualCost>0)).length)," per user"]})]})]})})]})]}):r.jsx("div",{className:"h-full flex items-center justify-center",children:r.jsxs("div",{className:"p-8 bg-white dark:bg-gray-800 rounded-lg shadow-sm text-center",children:[r.jsx(o,{className:"w-12 h-12 mx-auto mb-4 text-gray-400"}),r.jsx("p",{className:"text-xl mb-2 text-black dark:text-gray-100",children:"No data to display"}),r.jsx("p",{className:"text-sm text-black dark:text-gray-300",children:"Upload a CSV file to begin license analysis"})]})})})}),r.jsx("div",{className:"flex-none bg-gray-100 dark:bg-gray-800 border-t border-gray-200 dark:border-gray-700 text-center p-4",children:r.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"© 2025 St John Ambulance Canada / Gabriel Girouard. All rights reserved."})})]})})});j.createRoot(document.getElementById("root")).render(r.jsx(g.StrictMode,{children:r.jsx(le,{})}));
